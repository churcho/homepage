version: "2"
services:
  nginx:
    depends_on:
      - app
    image: jutonz/homepage-prod-nginx:3
    links:
      - app
    ports:
      - "4000:80"
  app:
    image: jutonz/homepage-prod-app:13
    depends_on:
      - psql
    environment:
      DATABASE_URL: postgres://docker:docker@psql:5432/homepage_prod
      PGHOST: psql
      PGUSER: docker
      PGPASS: docker
      PORT: "4000"
  psql:
    image: jutonz/homepage-prod-psql:5
    volumes:
      - ../../tmp/psql-prod:/var/lib/postgresql/data
      - ../..:/tmp/code
    environment:
      DATABASE_URL: postgres://docker:docker@localhost:5432/homepage_prod
